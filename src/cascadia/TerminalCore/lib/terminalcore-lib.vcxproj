<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="..\..\..\..\common.openconsole.props" Condition="'$(OpenConsoleDir)'==''" />

  <PropertyGroup>
    <ConfigurationType>StaticLibrary</ConfigurationType>
    <!-- We're a dll project, but we don't actually generate a dll.
         Set this to prevent msbuild from requiring we have a .def file. -->
    <NoDll>true</NoDll>
    <SubSystem>Console</SubSystem>
    <OpenConsoleUniversalApp>true</OpenConsoleUniversalApp>
  </PropertyGroup>

  <Import Project="$(OpenConsoleDir)src\cppwinrt.build.pre.props" />


  <!-- DONT ADD NEW FILES HERE, ADD THEM TO terminalcore-common.vcxproj -->
  <Import Project="$(OpenConsoleDir)src\cascadia\TerminalCore\terminalcore-common.vcxproj" />

  <PropertyGroup Label="Globals">
    <ProjectGuid>{CA5CAD1A-ABCD-429C-B551-8562EC954746}</ProjectGuid>
    <Keyword>Win32Proj</Keyword>
    <ProjectName>TerminalCore</ProjectName>
    <TargetName>TerminalCore</TargetName>
    <WindowsTargetPlatformMinVersion>10.0.17763.0</WindowsTargetPlatformMinVersion>
    <WindowsTargetPlatformVersion>10.0.17763.0</WindowsTargetPlatformVersion>
    <RootNamespace>Microsoft.Terminal.Core</RootNamespace>
  </PropertyGroup>
  <!-- ============================ References ============================  -->
  <ItemGroup>
    <ProjectReference Include="$(OpenConsoleDir)src\types\lib\types.vcxproj">
      <Project>{18D09A24-8240-42D6-8CB6-236EEE820263}</Project>
    </ProjectReference>
    <ProjectReference Include="$(OpenConsoleDir)src\buffer\out\lib\bufferout.vcxproj">
      <Project>{0cf235bd-2da0-407e-90ee-c467e8bbc714}</Project>
    </ProjectReference>
    <ProjectReference Include="$(OpenConsoleDir)src\renderer\base\lib\base.vcxproj">
      <Project>{af0a096a-8b3a-4949-81ef-7df8f0fee91f}</Project>
    </ProjectReference>
    <ProjectReference Include="$(OpenConsoleDir)src\terminal\parser\lib\parser.vcxproj">
      <Project>{3ae13314-1939-4dfa-9c14-38ca0834050c}</Project>
    </ProjectReference>
    <ProjectReference Include="$(OpenConsoleDir)src\renderer\dx\lib\dx.vcxproj">
      <Project>{48d21369-3d7b-4431-9967-24e81292cf62}</Project>
    </ProjectReference>
  </ItemGroup>

  <ItemGroup>
    <None Include="..\packages.config" />
  </ItemGroup>

  <ItemDefinitionGroup>
    <ClCompile>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <!-- WinRT_IncludePath is the SDK winrt path.
           cppwinrt is a sibling directory to it. This is needed for the
           #include <winrt/base>
           from the dll's header to be able to be found.
           Also manually include the generated header's path, because
           adding a project reference will confuse msbuild, because TerminalCore
           isn't a dll, it's a lib, and cppwinrt won't include a lib's header
      -->
      <AdditionalIncludeDirectories>$(WinRT_IncludePath)\..\cppwinrt\winrt;"$(OpenConsoleDir)src\cascadia\TerminalCore\lib\Generated Files";%(AdditionalIncludeDirectories);</AdditionalIncludeDirectories>
    </ClCompile>
  </ItemDefinitionGroup>

  <PropertyGroup>
    <!--
      DON'T REDIRECT OUR OUTPUT.
      Setting this will tell cppwinrt.build.post.props to copy our output from
      the default OutDir up one level, so the wapproj will be able to find it.
     -->
    <NoOutputRedirection>true</NoOutputRedirection>
    <!-- Don't copy out output up a directory either, because we're a lib, not
         a dll. We don't need our output copied up, because it'll be linked into
         TerminalControl, so the appx doesn't need to include us.
         If we try to xcopy the dll, it'll fail, because we don't build a dll.
     -->
    <DontCopyOutput>true</DontCopyOutput>
  </PropertyGroup>

  <!-- Careful reordering these. Some default props (contained in these files) are order sensitive. -->
  <Import Project="$(SolutionDir)src\common.build.lib.props" />
  <Import Project="$(SolutionDir)src\common.build.post.props" />
<!--
  <PropertyGroup>
    <OutDir>$(OpenConsoleDir)\$(Platform)\$(Configuration)\$(ProjectName)\</OutDir>
  </PropertyGroup> -->

  <Import Project="$(OpenConsoleDir)src\cppwinrt.build.post.props" />
</Project>
