!include $(NTMAKEENV)\system_defaultmk.inc
!include $(WINCORE_PATH)\core.inc
SOURCES_USED                    =  $(SOURCES_USED) $(WINCORE_PATH)\core.inc

_NT_TARGET_VERSION=$(_NT_TARGET_VERSION_LATEST)

W32_SB=1



TARGETNAME=console
TARGETTYPE=DYNLINK
TARGETEXT=dll
DLLENTRY=_DllMainCRTStartup

INCLUDES =  $(INCLUDES); \
            $(WINCORE_PATH)\console\open\src\propslib; \
            $(WINCORE_PATH)\w32inc; \
            $(SHELL_INC_PATH); \

                                  

TARGETLIBS=\
           $(SDK_LIB_PATH)\ntdll.lib  \
           $(MINCORE_SDK_LIB_VPATH)\mincore.lib \
           $(SDK_LIB_PATH)\kernel32.lib \
           $(SDK_LIB_PATH)\user32.lib  \
           $(SDK_LIB_PATH)\gdi32.lib \
           $(SDK_LIB_PATH)\advapi32.lib \
           $(SDK_LIB_PATH)\comctl32.lib \
           $(SDK_LIB_PATH)\shell32.lib \
           $(SDK_LIB_PATH)\propsys.lib \
           $(SDK_LIB_PATH)\shlwapi.lib \
           $(SDK_LIB_PATH)\uuid.lib \
           $(WINCORE_OBJ_PATH)\console\open\src\propslib\$(O)\conprops.lib \
           $(MINCORE_SDK_LIB_VPATH)\api-ms-win-core-winrt-error-l1.lib \
           $(SHELL_LIB_PATH)\api-ms-win-shcore-scaling-l1-1-1.lib \
           
DELAYLOAD=\
    api-ms-win-shcore-scaling-l1.dll; \

DLOAD_ERROR_HANDLER=kernelbase

USE_MSVCRT=1
USE_UNICRT=1
USE_NOTHROW_NEW=1 # use the CRT's non-throwing stock new/delete impl

C_DEFINES=$(C_DEFINES) -DISOLATION_AWARE_ENABLED -DUNICODE -D_UNICODE -DWIN32 -D_WIN32 -DSTRICT_CONST -DNT

UMTYPE=windows

SOURCES=dll.cpp              \
        readLink.cpp         \
        util.cpp             \
        console.cpp          \
        globals.cpp          \
        fontdlg.cpp          \
        OptionsPage.cpp      \
        ColorsPage.cpp       \
        LayoutPage.cpp       \
        init.cpp             \
        misc.cpp             \
        preview.cpp          \
        registry.cpp         \
        dbcs.cpp             \
        strid.mc             \
        PropSheetHandler.cpp \
        console.rc
 
SXS_APPLICATION_MANIFEST=WindowsShell.Manifest
SXS_MANIFEST_SOURCE = $(PROJECT_ROOT)

PRECOMPILED_CXX                 =   1
PRECOMPILED_INCLUDE             =   precomp.h
PRECOMPILED_PCH                 =   precomp.pch
PRECOMPILED_OBJ                 =   precomp.obj

TARGET_DESTINATION=retail
